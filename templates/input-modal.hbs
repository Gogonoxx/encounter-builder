<div class="encounter-builder-input">
  <div class="form-group">
    <label>Encounter Type</label>
    <div class="difficulty-options">
      <label class="radio-label">
        <input type="radio" name="encounterType" value="combat" checked />
        âš”ï¸ Combat
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="influence" />
        ğŸ—£ï¸ Influence
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="research" />
        ğŸ“š Research
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="chase" />
        ğŸƒ Chase
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="infiltration" />
        ğŸ­ Infiltration
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="dungeon" />
        ğŸ° Dungeon
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="lair" />
        ğŸ‰ Lair Boss
      </label>
      <label class="radio-label">
        <input type="radio" name="encounterType" value="travel" />
        ğŸ›¤ï¸ Travel
      </label>
    </div>
  </div>

  <!-- Party Level - needed for Combat, Influence, etc. (hidden for Travel) -->
  <div class="form-group party-level-group">
    <label for="partyLevel">Party Level</label>
    <input type="number" name="partyLevel" id="partyLevel" value="{{partyLevel}}" min="1" max="25" />
  </div>

  <!-- Influence-specific field (shown only when influence is selected) -->
  <div class="form-group influence-only" style="display: none;">
    <label for="influencePrompt">NPC & Ziel <span class="required">*</span></label>
    <textarea name="influencePrompt" id="influencePrompt" rows="5" placeholder="Beschreibe den NPC und was die Spieler erreichen wollen.

Beispiel:
HÃ¤ndler Marcus Wellford - die Spieler wollen einen besseren Preis fÃ¼r magische GegenstÃ¤nde aushandeln. Marcus war frÃ¼her selbst Abenteurer und respektiert Kampferfahrung."></textarea>
  </div>

  <!-- Research-specific field (shown only when research is selected) -->
  <div class="form-group research-only" style="display: none;">
    <label for="researchPrompt">Ort & Kontext <span class="required">*</span></label>
    <textarea name="researchPrompt" id="researchPrompt" rows="5" placeholder="Beschreibe den Forschungsort und welche Geheimnisse hier verborgen sind.

Beispiel:
Die Ruinen von Nyssilion - ein vergessener Tempel der 13. Ordnung. Die Spieler suchen Hinweise auf Kaelor DÃ¤mmerstahls Vergangenheit. Hier wurde der Pakt mit Kronos besiegelt."></textarea>
  </div>

  <!-- Chase-specific fields (shown only when chase is selected) -->
  <div class="form-group chase-only" style="display: none;">
    <label for="chaseType">Chase-Typ</label>
    <select name="chaseType" id="chaseType">
      <option value="run_away">ğŸƒ Flucht (PCs fliehen vor Verfolgern)</option>
      <option value="chase_down">ğŸ¯ Verfolgung (PCs jagen jemanden)</option>
      <option value="beat_clock">â±ï¸ Wettlauf gegen die Zeit</option>
      <option value="competitive">ğŸ Konkurrenz (zwei Gruppen zum Ziel)</option>
    </select>
  </div>

  <div class="form-group chase-only" style="display: none;">
    <label for="chaseLength">LÃ¤nge</label>
    <select name="chaseLength" id="chaseLength">
      <option value="6">Kurz (6 Hindernisse)</option>
      <option value="8" selected>Mittel (8 Hindernisse)</option>
      <option value="10">Lang (10 Hindernisse)</option>
    </select>
  </div>

  <div class="form-group chase-only" style="display: none;">
    <label for="chaseTerrain">Terrain</label>
    <select name="chaseTerrain" id="chaseTerrain">
      <option value="underground">ğŸ•³ï¸ Underground (HÃ¶hlen, Dungeons)</option>
      <option value="urban">ğŸ˜ï¸ Urban (Stadt, DÃ¤cher)</option>
      <option value="wilderness">ğŸŒ² Wilderness (Wald, Berge, FlÃ¼sse)</option>
      <option value="steppe">ğŸŒ¾ Steppe (Orfnir Grasland)</option>
      <option value="ruins">ğŸ›ï¸ Ruinen (Nyssilion, Tempel)</option>
      <option value="mixed">ğŸ² Gemischt</option>
    </select>
  </div>

  <div class="form-group chase-only" style="display: none;">
    <label for="chaseContext">Kontext <span class="required">*</span></label>
    <textarea name="chaseContext" id="chaseContext" rows="4" placeholder="Beschreibe die Chase-Situation: Wer jagt wen? Warum? Was passiert bei Erfolg/Misserfolg?

Beispiel:
Die Gruppe hat den Minotauren-Schrein entweiht und muss jetzt durch das unterirdische Labyrinth fliehen. Ghorvak Blutgeweih und seine Krieger sind ihnen auf den Fersen."></textarea>
  </div>

  <!-- Dungeon-specific fields (shown only when dungeon is selected) -->
  <div class="form-group dungeon-only" style="display: none;">
    <label for="dungeonSize">Dungeon-GrÃ¶ÃŸe</label>
    <select name="dungeonSize" id="dungeonSize">
      <option value="4">Klein (4 RÃ¤ume)</option>
      <option value="5" selected>Mittel (5 RÃ¤ume)</option>
      <option value="6">GroÃŸ (6 RÃ¤ume)</option>
    </select>
  </div>

  <div class="form-group dungeon-only" style="display: none;">
    <label for="dungeonTheme">Setting</label>
    <select name="dungeonTheme" id="dungeonTheme">
      <option value="ruins">ğŸ›ï¸ Ruinen (verfallene Strukturen)</option>
      <option value="cave">ğŸ•³ï¸ HÃ¶hle (natÃ¼rliche Formationen)</option>
      <option value="temple">â›ª Tempel (religiÃ¶se StÃ¤tte)</option>
      <option value="fortress">ğŸ° Festung (militÃ¤rische Anlage)</option>
      <option value="crypt">âš°ï¸ Krypta (GrabstÃ¤tte)</option>
      <option value="laboratory">ğŸ§ª Labor (Forschungseinrichtung)</option>
      <option value="mine">â›ï¸ Mine (Bergwerk)</option>
      <option value="sewers">ğŸš° Kanalisation (unterirdische Stadt)</option>
    </select>
  </div>

  <div class="form-group dungeon-only" style="display: none;">
    <label for="dungeonThreat">PrimÃ¤re Bedrohung</label>
    <select name="dungeonThreat" id="dungeonThreat">
      <option value="undead">ğŸ’€ Untote</option>
      <option value="construct">ğŸ¤– Konstrukte</option>
      <option value="humanoid">ğŸ‘¤ Humanoide (Banditen, Kultisten)</option>
      <option value="beast">ğŸº Bestien</option>
      <option value="aberration">ğŸ‘ï¸ Aberrationen</option>
      <option value="demon">ğŸ˜ˆ DÃ¤monen</option>
      <option value="elemental">ğŸ”¥ Elementare</option>
      <option value="ooze">ğŸŸ¢ Schleim</option>
      <option value="plant">ğŸŒ¿ Pflanzen</option>
      <option value="dragon">ğŸ‰ Drachen</option>
    </select>
  </div>

  <div class="form-group dungeon-only" style="display: none;">
    <label class="checkbox-label">
      <input type="checkbox" name="dungeonBoss" id="dungeonBoss" checked />
      Boss-Raum einschlieÃŸen
    </label>
  </div>

  <div class="form-group dungeon-only" style="display: none;">
    <label for="dungeonContext">Kontext <span class="required">*</span></label>
    <textarea name="dungeonContext" id="dungeonContext" rows="4" placeholder="Warum betreten die PCs den Dungeon? Was suchen sie?

Beispiel:
Die Spieler suchen das Grab von KÃ¶nig Aldric. Laut GerÃ¼chten ruht dort ein mÃ¤chtiges Artefakt - aber der KÃ¶nig wurde von einem Nekromanten verflucht und seine Wachen sind nie gestorben."></textarea>
  </div>

  <!-- Infiltration-specific fields (shown only when infiltration is selected) -->
  <div class="form-group infiltration-only" style="display: none;">
    <label for="infiltrationType">Infiltration-Typ (optional)</label>
    <select name="infiltrationType" id="infiltrationType">
      <option value="custom">Custom (beschreibe unten)</option>
      <option value="heist">Heist (etwas stehlen)</option>
      <option value="sabotage">Sabotage (etwas zerstÃ¶ren)</option>
      <option value="rescue">Rescue (jemanden befreien)</option>
      <option value="assassination">Assassination (jemanden eliminieren)</option>
      <option value="extraction">Extraction (Info beschaffen)</option>
    </select>
  </div>

  <div class="form-group infiltration-only" style="display: none;">
    <label for="infiltrationComplexity">KomplexitÃ¤t</label>
    <select name="infiltrationComplexity" id="infiltrationComplexity">
      <option value="5">Klein (5 IP - schneller Einsatz)</option>
      <option value="10" selected>Mittel (10 IP - Standard)</option>
      <option value="15">GroÃŸ (15 IP - komplexe Operation)</option>
    </select>
  </div>

  <div class="form-group infiltration-only" style="display: none;">
    <label for="infiltrationContext">Ziel & Kontext <span class="required">*</span></label>
    <textarea name="infiltrationContext" id="infiltrationContext" rows="5" placeholder="Beschreibe das Ziel, den Ort und die Situation.

Beispiel:
Die Spieler mÃ¼ssen in das Anwesen von Lord Vexaris einbrechen, um belastende Dokumente zu stehlen. Das Anwesen wird von Wachen patrouilliert und hat magische Alarmsysteme. Lord Vexaris ist heute Abend auf einem Ball."></textarea>
  </div>

  <!-- Lair-specific fields (shown only when lair is selected) -->
  <div class="form-group lair-only" style="display: none;">
    <label for="lairTerrain">Terrain</label>
    <select name="lairTerrain" id="lairTerrain">
      <option value="cave">ğŸ•³ï¸ HÃ¶hle</option>
      <option value="ruin">ğŸ›ï¸ Ruine</option>
      <option value="forest">ğŸŒ² Wald</option>
      <option value="swamp">ğŸŒ¿ Sumpf</option>
      <option value="mountain">â›°ï¸ Berg</option>
      <option value="desert">ğŸœï¸ WÃ¼ste</option>
      <option value="underwater">ğŸŒŠ Unterwasser</option>
      <option value="volcano">ğŸŒ‹ Vulkan</option>
      <option value="ice">â„ï¸ EiswÃ¼ste</option>
      <option value="plains">ğŸŒ¾ Ebene</option>
      <option value="jungle">ğŸŒ´ Dschungel</option>
      <option value="graveyard">âš°ï¸ Friedhof</option>
      <option value="tower">ğŸ—¼ Turm</option>
    </select>
  </div>

  <div class="form-group lair-only" style="display: none;">
    <label for="lairDifficulty">Boss-StÃ¤rke</label>
    <select name="lairDifficulty" id="lairDifficulty">
      <option value="2">âš”ï¸ Schwer (+2 Level)</option>
      <option value="3">ğŸ’€ TÃ¶dlich (+3 Level)</option>
    </select>
  </div>

  <div class="form-group lair-only" style="display: none;">
    <label for="lairContext">Kontext <span class="required">*</span></label>
    <textarea name="lairContext" id="lairContext" rows="5" placeholder="Warum betreten die PCs diesen Bau? Was bringt sie hierher?

Beispiel:
Die Spieler verfolgen einen alten Troll, der Dorfbewohner entfÃ¼hrt hat. Der Troll hat seinen Bau in einer HÃ¶hle hinter einem Wasserfall eingerichtet - dort hÃ¤lt er seine Gefangenen fÃ¼r spÃ¤ter fest."></textarea>
  </div>

  <!-- Travel-specific fields (shown only when travel is selected) -->
  <div class="form-group travel-only" style="display: none;">
    <label for="travelEncounterType">Encounter-Typ</label>
    <select name="travelEncounterType" id="travelEncounterType">
      <option value="random">ğŸ² Random (ZufÃ¤lliger Typ)</option>
      <option value="a_chance_meeting">ğŸ¤ A Chance Meeting (ZufÃ¤llige Begegnung)</option>
      <option value="a_bump_in_the_road">ğŸš§ A Bump in the Road (Hindernis)</option>
      <option value="hidden_reserves">ğŸ“¦ Hidden Reserves (Versteckte VorrÃ¤te)</option>
      <option value="needing_assistance">ğŸ†˜ Needing Assistance (Hilfe benÃ¶tigt)</option>
      <option value="danger_afoot">âš ï¸ Danger Afoot (Gefahr voraus)</option>
      <option value="natural_wonders">ğŸŒ„ Natural Wonders (Naturwunder)</option>
      <option value="monster_hunt">ğŸ¹ Monster Hunt (Monsterjagd)</option>
      <option value="a_place_to_rest">ğŸ•ï¸ A Place to Rest (Rastplatz)</option>
      <option value="old_memories">ğŸ›ï¸ Old Memories (Alte Erinnerungen)</option>
      <option value="a_dark_place">ğŸŒ‘ A Dark Place (Dunkler Ort)</option>
      <option value="deadly_fight">âš”ï¸ Deadly Fight (TÃ¶dlicher Kampf)</option>
      <option value="fateful_encounter">ğŸŒŸ Fateful Encounter (Schicksalhafte Begegnung)</option>
    </select>
  </div>

  <div class="form-group travel-only" style="display: none;">
    <label for="travelBiome">Biom <span class="required">*</span></label>
    <select name="travelBiome" id="travelBiome">
      <option value="coasts">ğŸ–ï¸ KÃ¼ste (Coasts)</option>
      <option value="desert">ğŸœï¸ WÃ¼ste (Desert)</option>
      <option value="farmlands">ğŸŒ¾ Agrarland (Farmlands)</option>
      <option value="forests">ğŸŒ² Wald (Forests)</option>
      <option value="grasslands" selected>ğŸŒ¿ Grasland (Grasslands)</option>
      <option value="mountains">â›°ï¸ Gebirge (Mountains)</option>
      <option value="open_waters">ğŸŒŠ Offenes Meer (Open Waters)</option>
      <option value="swamps">ğŸŠ Sumpf (Swamps)</option>
      <option value="underground">ğŸ•³ï¸ Untergrund (Underground)</option>
      <option value="urban">ğŸ˜ï¸ Stadt (Urban)</option>
      <option value="wildlands">ğŸ—» Wildnis (Wildlands)</option>
    </select>
  </div>

  <div class="form-group travel-only" style="display: none;">
    <label class="checkbox-label campaign-specific">
      <input type="checkbox" name="campaignSpecific" id="campaignSpecific" />
      ğŸ­ Kampagnenspezifisch (Fronten, Geheimnisse, Spieler-Hooks)
    </label>
    <p class="hint">Bindet aktive Dangers, Secrets und Spieler-Hooks aus der Orfnir-Kampagne ein.</p>
  </div>

  <div class="form-group travel-only campaign-fronts-section" id="front-selection-group" style="display: none;">
    <label>Fronten (optional - keine Auswahl = alle)</label>
    <div class="front-checkboxes">
      <label class="checkbox-label front-checkbox">
        <input type="checkbox" name="selectedFronts" value="etwas_erwacht_in_der_tiefe" />
        ğŸŒŠ Etwas erwacht in der Tiefe
      </label>
      <label class="checkbox-label front-checkbox">
        <input type="checkbox" name="selectedFronts" value="die_ostfront" />
        âš”ï¸ Die Ostfront
      </label>
      <label class="checkbox-label front-checkbox">
        <input type="checkbox" name="selectedFronts" value="der_mochtegern_erzmagier" />
        ğŸ§™ Der Mochtegern Erzmagier
      </label>
      <label class="checkbox-label front-checkbox">
        <input type="checkbox" name="selectedFronts" value="die_stimmen_der_steppe" />
        ğŸœï¸ Die Stimmen der Steppe
      </label>
    </div>
    <p class="hint">Beschraenkt Dangers und Secrets auf ausgewaehlte Fronten.</p>
  </div>

  <div class="form-group travel-only campaign-players-section" style="display: none;">
    <label>Anwesende Spieler (fÃ¼r Hook-Auswahl)</label>
    <div class="player-checkboxes">
      <label class="checkbox-label player-checkbox">
        <input type="checkbox" name="activePlayers" value="finn" checked />
        ğŸ‰ Finn (Dragon Disciple)
      </label>
      <label class="checkbox-label player-checkbox">
        <input type="checkbox" name="activePlayers" value="ignatius" checked />
        ğŸ”¥ Ignatius (Magier)
      </label>
      <label class="checkbox-label player-checkbox">
        <input type="checkbox" name="activePlayers" value="dante" checked />
        âš”ï¸ Dante (Krieger)
      </label>
      <label class="checkbox-label player-checkbox">
        <input type="checkbox" name="activePlayers" value="snaf" />
        ğŸ­ Snaf (Barde)
      </label>
      <label class="checkbox-label player-checkbox">
        <input type="checkbox" name="activePlayers" value="bernard" />
        ğŸ´ Bernard (Zentaur)
      </label>
    </div>
    <p class="hint">Gruppen-Hooks (Beutelbart, Errtu, Vaelorn, etc.) werden immer einbezogen.</p>
  </div>

  <!-- Combat-specific fields -->

  <div class="form-group combat-only">
    <label for="partySize">Number of Players</label>
    <input type="number" name="partySize" id="partySize" value="{{partySize}}" min="1" max="8" />
  </div>

  <div class="form-group combat-only">
    <label>Difficulty</label>
    <div class="difficulty-options">
      <label class="radio-label">
        <input type="radio" name="difficulty" value="moderate" {{#if (eq difficulty "moderate")}}checked{{/if}} />
        Moderate (80 XP)
      </label>
      <label class="radio-label">
        <input type="radio" name="difficulty" value="severe" {{#if (eq difficulty "severe")}}checked{{/if}} />
        Severe (120 XP)
      </label>
      <label class="radio-label">
        <input type="radio" name="difficulty" value="extreme" {{#if (eq difficulty "extreme")}}checked{{/if}} />
        Extreme (160 XP)
      </label>
    </div>
  </div>

  <div class="form-group combat-only">
    <label for="terrain">Terrain</label>
    <select name="terrain" id="terrain">
      {{#each terrainOptions}}
        <option value="{{this.value}}">{{this.label}}</option>
      {{/each}}
    </select>
  </div>

  <div class="form-group combat-only">
    <label>Include Creature Types (optional)</label>
    <div class="trait-checkboxes">
      {{#each creatureTraits}}
        <label class="checkbox-label">
          <input type="checkbox" name="includeTraits" value="{{this}}" />
          {{this}}
        </label>
      {{/each}}
    </div>
  </div>

  <div class="form-group combat-only">
    <label>Exclude Creature Types (optional)</label>
    <div class="trait-checkboxes">
      {{#each creatureTraits}}
        <label class="checkbox-label">
          <input type="checkbox" name="excludeTraits" value="{{this}}" />
          {{this}}
        </label>
      {{/each}}
    </div>
  </div>

  <div class="form-group">
    <label class="checkbox-label">
      <input type="checkbox" name="comedicRelief" id="comedicRelief" />
      ğŸ˜„ Comedic Relief (humorvoller Encounter)
    </label>
    <p class="hint">Der Encounter soll lustig und unterhaltsam sein - eine leichte Pause vom ernsten Abenteuer.</p>
  </div>

  <div class="form-group combat-only">
    <label for="narrativeHook">Narrative Hook (optional)</label>
    <textarea name="narrativeHook" id="narrativeHook" rows="3" placeholder="E.g., The players are searching for a missing merchant in the swamp..."></textarea>
  </div>

  <div class="form-group travel-only" style="display: none;">
    <label for="travelContext">Kontext (optional)</label>
    <textarea name="travelContext" id="travelContext" rows="3" placeholder="ZusÃ¤tzlicher Kontext fÃ¼r den Encounter.

Beispiel:
Die Gruppe reist von Orfnir nach SÃ¼den und folgt einem alten Handelsweg."></textarea>
  </div>

  <div class="form-buttons">
    <button type="button" class="cancel-btn" data-action="close">
      <i class="fas fa-times"></i> Cancel
    </button>
    <button type="submit" class="generate-btn">
      <i class="fas fa-dice-d20"></i> Generate Encounter
    </button>
  </div>
</div>
